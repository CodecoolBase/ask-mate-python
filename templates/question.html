<!DOCTYPE html>
<html lang="en">
<head>
<style>
    ul {list-style-type: none;}
    #bignum {font-size: 2em; color: blue;}

    .title {display: flex; align-items: baseline}
    .block {border: 2px solid grey; overflow: hidden; display:flex; flex-direction:row;}
    .column {display: flex; flex-direction: column; max-width: 25vh; align-items: center; padding: 10px;}
    .content {display: flex; flex: 1 1 auto; flex-direction: column; background: grey; margin: 5px;  }
    .msg {background: white; flex: 1 1 auto;}
    .navbar {display: flex; justify-content: right; align-items: center; background: red; height: min-content;}
    .navbar > * {margin-right: 10px;}
    .comments {padding-left: 25vh; background: yellow;}
    .answerblock {margin: 20px;}

</style>
    <meta charset="UTF-8">
    <title>{{ question['title'] }}</title>
    {% block head %} {% endblock %}
</head>
<body>
    <div class="title">

        <img class=imgblock
             src="{{ url_for('static', filename=('images/' + question['image'])) if question['image'] else '/static/images/basic.png' }}"
             alt="No image">
        <h1>{{ question['title'] }}</h1>
    </div>
    <div class="block">
        <div class="column">

            <a href='/question/{{ question['id'] }}/vote_up'><img src="/static/images/upvote.png" height="20" width="20"></a>
            <p id="bignum">{{ question['vote_number'] }}</p>
            <a href='/question/{{ question['id'] }}/vote_down'><img src="/static/images/downvote.png" height="20" width="20"></a>
            <p>Viewed: {{ question['view_number'] }}</p>

        </div>
        <div class="content">
            <div class="msg">{{ question['message'] }}</div>
            <div class="navbar">
                <p>username</p>
                <p>{{ question['submission_time'] }}</p>

                {% if not addinganswer %}
                    <form action="{{ url_for('edit_question', question_id=question['id']) }}" method="get">
                        <button type="submit" name="edit_question" id="edit_question" value="Edit question">Edit question</button>
                        </form>
                    <a href="/question/{{ question['id'] }}/delete"><button>Delete question</button></a>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="comments">
        <div class="msg">
        {% for comment in comments %}
            {% if comment["question_id"] == question_id and comment["answer_id"] == None %}
                {{ comment["message"] }}

                <div class="navbar">
                    {% if comment["edited_count"] != 0 %}
                    <span>Edited by {{ comment["edited_count"] }} times</span>
                    {% endif %}
                    <span>{{ comment["submission_time"] }}</span>
                    {% if not addinganswer %}
                        <a href="{{ url_for('delete_comment', question_id=question_id, comment_id=comment['id']) }}"
                           onclick="return confirm('Are you sure, you want to delete this comment?')">
                            <img src="/static/images/recyclebin.jpg" height="20" width="20">
                        </a>
                        <a href="{{ url_for('edit_comment', comment_id=comment['id']) }}">Edit</a>
                    {% endif %}
                </div>
            {% endif %}
        {% endfor %}
        </div>
    </div>


    {% if addinganswer %}
        {% block givinganswer %}{% endblock %}
    {% else %}
        <a href="{{ url_for('write_new_comment', question_id=question['id']) }}"><button>Add comment</button></a>
        <form action="/questions/{{ question['id'] }}" method="GET">
        <button type="submit" name="addinganswer">Add Answer</button>
        </form>
    {% endif %}

    <p></p>
    <h3><label>Answers:</label></h3>
    {% if answers %}
        {% for answer in answers %}
            {% block answer scoped %} {% endblock%}
        {% endfor %}
    {% else %}
        <p>There are no answers to this question yet</p>
    {% endif %}

    <nav>
        <a href={{ url_for('show_questions') }}>Go back</a>
    </nav>

</body>
</html>
