<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ question[4]}}</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
          integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
</head>
<style>
    html{
        height: 100%;
        overflow: hidden;
    }

    body {
        margin: 0;
        padding: 0;
        background: url("http://mozinormontreuil.fr/wp-content/uploads/2015/10/bg-parallax-diamond.jpg");
        background-attachment: fixed;
        height: 100%;
    }

    h1{
        position: relative;
        left: 5%;
    }
	h3 {
        margin-right: 100px;
        text-align: right;
	    }

    .vote{
        padding-top: 12px;
        text-align: right;
    }

    .question {
        border-style: ridge;
        border-width: 5px;
        border-color: coral;
        background-color: white;
        color: black;
        margin: 1%;
        padding: 1%;
        padding-top: 3px;
        padding-bottom: 0px;
        width: 80%;
        position: relative;
        left: 8%;
    }


    .answers {
        border-radius: 25px;
        background-color: #3B211F;
        color: black;
        margin: 1% ;
        padding: 1%;
        border: 3px black;
        width: 60%;
        position: relative;
        left: 20%;
        overflow: auto;
        height: 55%;
    }


    .even {
        border-radius: 25px;
        background-color: #A0907F;
        color: black;
        margin: 5px auto;
        padding: 20px;
        padding-bottom: 0px;
        padding-top: 0px;
        width: 50%;
        border: 3px black;
    }

    textarea{
        border: 1px;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }

    .odd {
        border-radius: 25px;
        background-color: #A0907F;
        color: black;
        margin: 5px auto;
        padding: 20px;
        padding-bottom: 0px;
        padding-top: 0px;
        width: 50%;
        border: 3px black;
    }

    .line {
        width: 20%;
        position: relative;
        left: 40%;
    }

    .date {
        padding: 5px;
    }

    .trash {
        text-align: right;
        padding: 0%;
        margin: 0%;
        float: right;
    }

    .edit {
        text-align: right;
        padding: 0%;
        margin: 0%;
        float: right;
    }

    .wrap {
       word-wrap: break-word;
    }

    .spoilerbutton {
        display: block;
        margin: 0;
    }

    .spoiler {
        overflow: hidden;
        background: #f5f5f5;
        width: fit-content;
        height: fit-content;
    }

    .spoiler>div {
        margin: 0;
        overflow: hidden;
        transition: all 1s ease;
        width: fit-content;
        height: fit-content;
    }

    .spoilerbutton[value="Show Image"]+.spoiler>div {
      max-height: 0;
    }

    .spoilerbutton[value="Hide Image"]+.spoiler>div {
        max-height: 400px;
    }

    .update_question{
        font-size: 11pt;
        height: 200px;
        width: 100%;
        -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
        -moz-box-sizing: border-box;    /* Firefox, other Gecko */
        box-sizing: border-box;         /* Opera/IE 8+ */
        white-space: pre-wrap;
        resize: none;
    }

    .question_message{
        white-space: pre-wrap;
    }

    .spoilerbutton2[value="Show Comments"]+.spoiler>div {
      max-height: 0;
    }

    .spoilerbutton2[value="Hide Comments"]+.spoiler>div {
        max-height: 400px;
    }

</style>

<body>
    <h3>{{ question['submission_time'] }}</h3>
    <h1>{{ question['title'] }}</h1>
    <div class="question" contenteditable="{{ editable }}">
        <div class="edit">
            {% if not editable %}
                <form action="/edit/{{ question.id }}" method="POST">
                    <input type="text" hidden name="edit" value="edit">
                    <input type="submit" class="fas fa-edit" value="&#xf044"; Input>
                </form>
            {% endif %}
        </div>
        <div class="trash">
            <form action="/delete" method="POST">
                <input type="number" hidden name="questid" value="{{question['id']}}">
                <input type="submit" class="fas fa-trash" value="&#xf1f8"; Input>
            </form>
        </div>
        <div class="message">
            {% if editable %}
                <form action="/question/{{ question.id }}" method="POST">
                    <input type="text" hidden name="save" value="save">
                        <form action="/question/{{ question.id }}" method="POST">
                            <textarea oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"' class="update_question" name="updated" value="{{ question['message'] }}">{{ question['message'] }}</textarea>
                            <input type="submit" class="fas fa-save trash" value="UPDATE"; Input>
                        </form>
            {% else %}
                    <p class="question_message"><font size="4">{{ question['message'] }}</font></p>
            {% endif %}
            {% if question['image'] %}
            <br>
            <input class="spoilerbutton" type="button" value="Show Image" onclick="this.value=this.value=='Show Image'?'Hide Image':'Show Image';">
            <div class="spoiler">
                <div><img src="{{ question['image'] }}" height="400"></div>
            </div>
            {% endif %}
            <input class="spoilerbutton2" type="button" value="Show Comments" onclick="this.value=this.value=='Show Comments'?'Hide Comments':'Show Comments';">
            <div class="spoiler">
                {% for comment in question_comments %}
                <div>
                    {{ comment }}
                </div>
            </div>
        </div>
        <p class="vote">
            <a href="{{ url_for("vote", type="question", question_id=question['id'], type_id=question['id'], direction="up") }}"><i class="fas fa-arrow-up"></i></a>
            <a href="{{ url_for("vote", type="question", question_id=question['id'], type_id=question['id'], direction="down") }}"><i class="fas fa-arrow-down"></i></a>
            {{ question['vote_number'] }}
        </p>
    </div>
    <p align="center"><button onclick="window.location.href='/'">Back</button></p>
    <div class="answers">
    {% if answers|length == 0 %}
        <p class="even wrap"><font size="4">No answers found</font></p>
    {% else %}
        {% for i in range(answers|length) %}
            {% if i % 2 == 0 %}
            <form action="/delete_answer" method="POST">
                <input type="number" hidden name="answer_id" value="{{ answers[i]['id'] }}">
                <input type="number" hidden name="question_id" value="{{ answers[i]['question_id'] }}">
                <p class="trash"><input type="submit" class="fas fa-trash" value="&#xf1f8"; Input><br></p>
            </form>
                <div class="even wrap">
                    <p class="date">{{ answers[i]['submission_time'] }}</p>
                    <font size="4">{{ answers[i]['message'] }}</font>
                    <p class="vote">
                    <a href="{{ url_for("vote", type="answer", question_id=answers[i]['question_id'], type_id=answers[i]['id'], direction="up") }}"><i class="fas fa-arrow-up"></i></a>
                    <a href="{{ url_for("vote", type="answer", question_id=answers[i]['question_id'], type_id=answers[i]['id'], direction="down") }}"><i class="fas fa-arrow-down"></i></a>
                    {{ answers[i]['vote_number'] }}
                    </p>
                </div>
            {% else %}
            <form action="/delete_answer" method="POST">
                <input type="number" hidden name="answer_id" value="{{answers[i]['id']}}">
                <input type="number" hidden name="question_id" value="{{ answers[i]['question_id'] }}">
                <p class="trash"><input type="submit" class="fas fa-trash" value="&#xf1f8"; Input><br></p>
            </form>
                <div class="odd wrap">
                    <p class="date">{{ answers[i]['submission_time']}}</p>
                    <font size="4">{{ answers[i]['message'] }}</font>
                    <p class="vote">
                    <a href="{{ url_for("vote", type="answer", question_id=answers[i]['question_id'], type_id=answers[i]['id'], direction="up") }}"><i class="fas fa-arrow-up"></i></a>
                    <a href="{{ url_for("vote", type="answer", question_id=answers[i]['question_id'], type_id=answers[i]['id'], direction="down") }}"><i class="fas fa-arrow-down"></i></a>
                    {{ answers[i]['vote_number'] }}
                    </p>
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}
        <form action="/answer/{{question['id']}}" method="post">
            <div class="wrap" align="center">
                <textarea name="answertext" rows="12" cols="60" minlength="10" placeholder="Write an answer..."></textarea>
                <p align="right"><input type="submit" value="Send"></p>
            </div>
        </form>
    </div>
</body>
</html>